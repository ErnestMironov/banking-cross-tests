# Анализ граничных условий банковского сервиса
## Тестировщик: Самелюк Юрий Дмитриевич

## Методология тестирования
- **Подход**: Эквивалентное разбиение
- **Техника**: Анализ граничных значений
- **Приоритет**: Критические бизнес-процессы

## Матрица тестирования

### 1. Валидация баланса
| Класс | Значения | Ожидаемый результат |
|-------|----------|-------------------|
| Валидный | 0, 1, 999999 | Принято |
| Невалидный | -1, 1000000 | Отклонено |
| Граничный | 0, 1, 999999 | Принято |

### 2. Валидация резерва
| Класс | Значения | Ожидаемый результат |
|-------|----------|-------------------|
| Валидный | 0, 1, 999999 | Принято |
| Невалидный | -1, 1000000 | Отклонено |
| Граничный | 0, 1, 999999 | Принято |

## Тест-кейсы

### TC-006: Анализ граничных значений баланса
**Приоритет**: P0
**Риск**: Высокий
**Сложность**: Средняя

#### Анализ входных данных
```python
def analyze_balance(balance):
    if balance < 0:
        return "INVALID"
    if balance > 999999:
        return "INVALID"
    return "VALID"

# Тестовые значения
test_values = [-1, 0, 1, 999999, 1000000]
```

#### Шаги выполнения
1. **Подготовка данных**
   - Сгенерировать тестовые значения
   - Подготовить ожидаемые результаты

2. **Выполнение тестов**
   - Открыть URL с каждым тестовым значением
   - Зафиксировать реакцию системы
   - Сравнить с ожидаемым результатом

3. **Анализ результатов**
   - Собрать статистику
   - Выявить паттерны ошибок
   - Составить отчет

#### Ожидаемые результаты
```json
{
  "valid_cases": {
    "0": "accepted",
    "1": "accepted",
    "999999": "accepted"
  },
  "invalid_cases": {
    "-1": "rejected",
    "1000000": "rejected"
  }
}
```

#### Статистика тестирования
- Всего тестов: 5
- Успешных: 3
- Неуспешных: 2
- Покрытие: 100%

**Окружение:** Chrome 137, macOS  
**Статус:** Не пройдено

### TC-007: Валидация номера карты - граничные случаи
**Приоритет**: Высокий  
**Предусловия**: Открыто меню ввода номера карты

**Шаги**:
1. Нажать на рублёвый счёт
2. Ввести номер карты с более чем 16 цифрами: 12345678901234567890
3. Проверить поведение системы
4. Ввести номер карты с буквами: 1234abcd56789012
5. Проверить валидацию
6. Ввести номер карты с пробелами: 1234 5678 9012 3456

**Ожидаемый результат:**
- Система должна ограничить ввод номера карты максимум 16 цифрами (стандарт для большинства платежных систем РФ)
- Попытка ввода 17 и более цифр не должна быть разрешена в интерфейсе
- При любом случае превышения длины номера должна показываться ошибка валидации и блокировка операции отправки средств
- Денежные средства могут быть отправлены только на существующий корректный номер карты

**Фактический результат:**
- Система допускает ввод и отправку средств с номером карты длиной ровно 17 цифр
- Отправка средств происходит на несуществующий номер, что может привести к потере средств
- При вводе больше 17 цифр система блокирует (т.е. ограничение именно на 17 цифр, а не на 16)
- Отсутствует корректная проверка длины номера карты и существования карты перед отправкой средств

**Окружение:** Chrome 137, macOS  
**Статус:** Не пройдено

---

### TC-008: Проверка расчёта комиссии с округлением вниз
**Приоритет**: Высокий  
**Предусловия**: Доступная сумма достаточна для тестирования

**Шаги**:
1. Ввести корректный номер карты: 1234567890123456
2. Ввести сумму перевода: 55 (комиссия должна быть 5.5, округляется до 5)
3. Проверить отображение комиссии
4. Ввести сумму перевода: 199 (комиссия должна быть 19.9, округляется до 19)
5. Проверить отображение комиссии

**Ожидаемый результат:**
- Комиссия рассчитывается как 10% от суммы перевода и округляется **в меньшую сторону** до целого числа (например, 5.5 → 5, 19.9 → 19).
- Комиссия обязательно отображается пользователю для всех корректных сумм перевода, включая небольшие суммы (например, 55), без пропусков.
- Итоговая сумма к списанию равна сумме перевода плюс правильно округлённая комиссия.
- Отображаемые комиссии и итоговые суммы должны быть точными и не ниже ожидаемых значений, исключая ошибки недоучёта комиссии (т.е. комиссия не может быть занижена, например, до 10 вместо 19 при сумме 199).
- Интерфейс не должен скрывать или пропускать информацию о комиссии.

**Фактический результат:**
- При вводе суммы `55` комиссия **не отображается вовсе**, хотя должна быть `5` (с округлением вниз от 5.5).
- При вводе суммы `199` комиссия отображается как `10` вместо ожидаемых `19`, что некорректно и существенно меньше правильной комиссии.

**Окружение:** Chrome 137, macOS  
**Статус:** Не пройдено

---

### TC-009: Проверка поведения при равенстве суммы перевода и доступной суммы
**C-009-1: Проверка перевода при сумме перевода меньше доступной (с комиссией)**

**Приоритет:** Средний
**Предусловия:** balance=11000 & reserved=0 (доступно 11000)

**Шаги:**
1. Открыть: http://localhost:8000/?balance=11000&reserved=0
2. Ввести корректный номер карты: 1234567890123456
3. Ввести сумму перевода: 9999
4. Учесть комиссию (например, 10% от суммы, т.е. 999) — итого к списанию 10998 (или 990 по вашему примеру)
5. Проверить возможность перевода

**Ожидаемый результат:**
- Перевод разрешён, так как общая сумма перевода с комиссией (10989) меньше доступного баланса (11000).

**Фактический результат:**
- Перевод удался, отобразилось сообщение об успешной операции:
«Перевод 9999 ₽ на карту 1234567890123456 принят банком!»

**Окружение:** Chrome 137, macOS  
**Статус:** Пройдено

C-009-2: Проверка перевода при сумме перевода равной доступной (с комиссией)
**Приоритет:** Средний
**Предусловия:** balance=11000 & reserved=0 (доступно 11000)

**Шаги:**
1. Открыть: http://localhost:8000/?balance=11000&reserved=0
2. Ввести корректный номер карты: 1234567890123456
3. Ввести сумму перевода: 10000
4. Учесть комиссию (например, 10% от суммы, т.е. 1000) — итого к списанию 11000
5. Проверить возможность перевода

**Ожидаемый результат:**
- Перевод разрешён, так как общая сумма перевода с комиссией ровна доступному балансу (граничное значение).

**Фактический результат:**
- Отправить средства не получилось, хотя ровно хватало на отправку.
- Кнопка “Отправить” пропадает.
- Отображается сообщение об ошибке: “Недостаточно средств на счете”.

**Окружение:** Chrome 137, macOS  
**Статус:** Не пройдено

---

### TC-010: Проверка поведения с различными параметрами URL
**Приоритет**: Средний  
**Предусловия**: Сервис запущен

**Шаги:**
1. Открыть http://localhost:8000 (без параметров)
2. Проверить поведение системы
3. Открыть http://localhost:8000/?balance=abc&reserved=def
4. Проверить обработку некорректных параметров
5. Открыть http://localhost:8000/?reserved=5000&balance=1000 (резерв больше баланса)
6. Проверить валидацию параметров

**Ожидаемый результат:**
- При отсутствии параметров в URL отображаются значения по умолчанию: рублевый баланс и резерв — 0, долларовый и евро счета и резервы — заданные в системе стандартные значения (например, 100 и 0 для доллара, 300 и 26 для евро).
- При передаче некорректных параметров (`balance=abc`, `reserved=def`) баланс и резерв в пользовательском интерфейсе отображаются как 0, а не как `NaN` или другие некорректные значения.
- При ситуации, когда резерв больше баланса (`reserved > balance`), система не позволяет совершить операцию и корректно отображает сообщение об ошибке: «Недостаточно средств на счете».
- Интерфейс не должен показывать технические или непонятные значения (например, `NaN`), а только читаемые для пользователя корректные числовые значения или предупреждения.

**Фактический результат:**
1. При открытии без параметров отображается:
- рублевый баланс: 0, резерв: 0
- долларовый счет: 100, резерв: 0
- евро счет: 300, резерв: 26
Всё работает корректно, значения по умолчанию отображаются верно.
2. При открытии с некорректными параметрами (`balance=abc`, `reserved=def`):
- В разделе рублёвых счетов вместо ожидаемых 0 отображается `NaN` на балансе и в резерве.
- Такое поведение неприемлемо для пользовательского интерфейса, т.к. `NaN` непонятно пользователю и может вызвать путаницу.
3. При открытии с параметрами, где резерв превышает баланс (`balance=1000`, `reserved=5000`):
- Отображается сообщение об ошибке оплаты: “Недостаточно средств на счете”.
- Поведение соответствует ожиданиям и корректно сигнализирует о проблеме с отрицательным доступным балансом.

**Окружение:** Chrome 137, macOS  
**Статус:** Частично пройдено
- Без параметров и при резерве больше баланса — работает корректно
- При некорректных параметрах — выявлена ошибка отображения (NaN вместо 0), требуется исправление
